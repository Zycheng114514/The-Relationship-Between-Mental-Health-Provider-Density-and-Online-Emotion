library(pacman)
p_load(tidyverse,ggplot2)
dta<-read.csv("data/cleaned/the_data.csv")
View(dta)
dta$state
dta0<-dta
dta<-dta%>%
filter(!is.na(median_age))
View(dta)
library(pacman)
p_load(tidyverse,ggplot2)
dta<-read.csv("data/cleaned/the_data.csv")
library(pacman)
p_load(tidyverse,ggplot2)
dta<-read.csv("data/cleaned/the_data.csv")
dta0<-dta
dta<-dta%>%
filter(!is.na(median_age))
View(dta)
colnames(dta)
View(dta)
test<-dta%>%
filter(year=2018)
test<-dta%>%
filter(year==2018)
View(test)
ggplot(data = dta, aes(x = city, y = year, fill = negative_rate)) +
geom_tile(color = "white") +
scale_fill_gradient2(
low = "blue",
high = "red",
mid = "white",
midpoint = 0,
limit = c(-1,1),
name = "Correlation"
) +
theme_minimal() +
coord_fixed() +
theme(
axis.text.x = element_text(angle = 45, vjust = 1, size = 10, hjust = 1),
axis.title.x = element_blank(),
axis.title.y = element_blank()
)
ggplot(data = dta, aes(x = city, y = year, fill = negative_rate)) +
geom_tile(color = "white") +
scale_fill_gradient2(
low = "blue",
high = "red",
mid = "white",
midpoint = 0,
limit = c(-1,1),
name = "Correlation"
) +
theme_minimal() +
coord_fixed() +
)
ggplot(data = dta, aes(x = city, y = year, fill = negative_rate)) +
geom_tile(color = "white") +
scale_fill_gradient2(
low = "blue",
high = "red",
mid = "white",
midpoint = 0,
limit = c(-1,1),
name = "Correlation"
) +
theme_minimal() +
coord_fixed()
)
ggplot(data = dta, aes(x = city, y = year, fill = negative_rate)) +
geom_tile(color = "white") +
theme_minimal() +
coord_fixed()
)
dta_heat<-dta%>%
sort(total_observations,decreasing = TRUE)
dta_heat<-dta%>%
arrange(total_observations,desc = TRUE)
ggplot(data = dta_heat, aes(x = city, y = year, fill = negative_rate)) +
geom_tile(color = "white") +
theme_minimal() +
coord_fixed()
)
dta_heat<-dta%>%
arrange(total_observations,desc = TRUE)
ggplot(data = dta_heat, aes(x = city, y = year, fill = negative_rate)) +
geom_tile(color = "white") +
theme_minimal() +
coord_fixed()
)
dta_heat<-dta%>%
arrange(total_observations,desc = TRUE)
ggplot(data = dta_heat, aes(x = city, y = year, fill = negative_rate)) +
geom_tile(color = "white") +
theme_minimal() +
coord_fixed()
View(dta_heat)
dta_heat <- dta %>%
mutate(city = fct_reorder(city, total_observations, .desc = TRUE))
ggplot(data = dta_heat, aes(x = city, y = year, fill = negative_rate)) +
geom_tile(color = "white") +
theme_minimal() +
coord_fixed()
library(pacman)
library(readxl)
p_load(tidyverse,ggplot2)
dta <- read_excel("final_data.xlsx")
library(pacman)
library(readxl)
p_load(tidyverse,ggplot2)
dta <- read_excel("data/cleaned/final_data.xlsx")
View(dta)
model_a<-lm(negative_rate~density+income+average_years_schooling + mean_work_hours + mental_health_provider_rate, data= dta)
summary(model_a)
model_b<-lm(negative_submission_rate~density+average_years_schooling+income+ mean_work_hours + mental_health_provider_rate, data= dta)
summary(model_b)
model_c<-lm(negative_comment_rate~density+average_years_schooling+income+ mean_work_hours + mental_health_provider_rate, data= dta)
summary(model_c)
model_test<-lm(negative_rate~density+average_years_schooling+income+ mean_work_hours + mental_health_provider_rate, data= dta)
summary(model_test)
dta_heat <- dta %>%
mutate(city = fct_reorder(city, total_observations, .desc = TRUE))
ggplot(data = dta_heat, aes(x = city, y = year, fill = negative_rate)) +
geom_tile(color = "white") +
theme_minimal() +
coord_fixed()
library(ggplot2)
library(dplyr)
library(forcats)
dta_heat <- dta %>%
mutate(city = fct_reorder(city, total_observations, .desc = TRUE))
ggplot(data = dta_heat, aes(x = city, y = factor(year), fill = negative_rate)) +
geom_tile(color = "white", linewidth = 0.5) +
scale_fill_gradient(low = "#fff200", high = "#8b00ff") +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
plot.title = element_text(size = 18, face = "bold")
) +
labs(
title = "Negative Rate by City and Year",
x = "City",
y = "Year",
fill = "Negative Rate"
) +
coord_fixed()
